<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CAC Tree â€” Golf Trip Hall of Fame</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <div id="header">
    <div style="display:flex;align-items:baseline;">
      <h1>CAC Tree</h1>
      <span class="subtitle">Golf Trip Hall of Fame</span>
    </div>
    <div id="header-controls">
      <div id="legend">
        <span class="legend-item"><span style="color:#d4a843;">&#9733;</span> = win</span>
        <span class="legend-item"><span style="color:#6a7290;">'19 (6y)</span> = started, total years</span>
        <span class="legend-item">click node for details</span>
      </div>
      <div id="filters">
        <label for="year-filter">Year:</label>
        <select id="year-filter">
          <option value="">All Years</option>
        </select>
        <input type="text" id="search-input" placeholder="Search members...">
      </div>
    </div>
  </div>

  <div id="main">
    <div id="tree-container">
      <div id="zoom-controls">
        <button id="zoom-in" title="Zoom in">+</button>
        <button id="zoom-out" title="Zoom out">&minus;</button>
        <button id="zoom-fit" title="Fit to view">&#8859;</button>
      </div>
    </div>

    <div id="detail-panel">
      <button id="detail-close">&times;</button>
      <div id="detail-photo-wrap">
        <div class="detail-placeholder">?</div>
      </div>
      <div id="detail-lord-badge"><span>&#9819; Lord</span></div>
      <div id="detail-name"></div>
      <div id="detail-nickname"></div>
      <div id="detail-hometown"></div>

      <div class="detail-stats">
        <div class="detail-stat">
          <div class="detail-stat-value" id="stat-years">0</div>
          <div class="detail-stat-label">Years</div>
        </div>
        <div class="detail-stat">
          <div class="detail-stat-value" id="stat-wins">0</div>
          <div class="detail-stat-label">Wins</div>
        </div>
      </div>

      <div class="detail-section">
        <h3>Years Attended</h3>
        <div class="detail-years-list" id="detail-years"></div>
      </div>

      <div class="detail-section">
        <h3>Sponsored By</h3>
        <p id="detail-sponsor"></p>
      </div>

      <div class="detail-section">
        <h3>The Story</h3>
        <p id="detail-story"></p>
      </div>
    </div>
  </div>

  <script src="js/detail.js"></script>
  <script src="js/tree.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      DetailPanel.init();
      TreeViz.init();

      // Search
      const searchInput = document.getElementById('search-input');
      let debounce;
      searchInput.addEventListener('input', () => {
        clearTimeout(debounce);
        debounce = setTimeout(() => TreeViz.search(searchInput.value), 200);
      });

      // Year filter
      const yearFilter = document.getElementById('year-filter');
      yearFilter.addEventListener('change', () => {
        const year = yearFilter.value ? parseInt(yearFilter.value) : null;
        TreeViz.filterByYear(year);
      });

      // Close panel on Escape
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          DetailPanel.close();
          searchInput.value = '';
          yearFilter.value = '';
          TreeViz.search('');
          TreeViz.filterByYear(null);
        }
      });
    });
  </script>
</body>
</html>
